FROM mcr.microsoft.com/dotnet/sdk:10.0 AS build
WORKDIR /app

COPY ./src/app/BooksApi.App/*.csproj ./src/app/BooksApi.App/
RUN dotnet restore ./src/app/BooksApi.App/BooksApi.App.csproj

COPY ./src/app/BooksApi.App/ ./src/app/BooksApi.App/
RUN dotnet publish ./src/app/BooksApi.App/BooksApi.App.csproj -c Release -o /app/publish --no-restore

FROM gcr.io/distroless/base-debian12:nonroot
WORKDIR /app

COPY --from=build /app/publish/ /app/

EXPOSE 8080

# Healthcheck removed - using docker-compose level healthchecks instead
# Distroless images don't have curl/wget, so healthchecks are handled at compose level

ENTRYPOINT ["/app/BooksApi.App"]